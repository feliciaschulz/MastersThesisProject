# need averages df for this and celltypes df#source("create_data.R")library(ggplot2)library(ggpubr)fulldf = averages_winsorizedfulldf$InferredCellType = celltypes$InferredCellTypefulldf$InferredCellType = as.factor(fulldf$InferredCellType)allmarkers = names(averages)# Loop through the vector of markersplots <- list()for (m in allmarkers) {  mcol = fulldf[[m]]  # Generate your plot for each cell type (replace with your actual plotting code)  plots[[m]] <- ggplot(fulldf, aes_string(x = "InferredCellType", y = m, fill = "InferredCellType")) +    geom_violin() +    labs(title = paste(m), y = 'Intensity') +   # theme_minimal() +    theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))}# get all plotsggarrange(plotlist=plots, ncol=5, nrow=2, common.legend = TRUE, legend="bottom")# get singular plot#plots$actin