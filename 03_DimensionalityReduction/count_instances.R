# have to have celltypes data from create_data.RView(celltypes)#1 Make table for counts of celltypescelltype_counts <- table(celltypes$InferredCellType)celltype_counts#2 Make table for biomarker expressionsmarkers <- names(celltypes[-length(celltypes)]) # all except inf.celltype# Function to count positive occurrences of markers for each inferred cell typecount_positives <- function(celltypes, marker) {  aggregate(celltypes[[marker]], by = list(celltypes$InferredCellType), FUN = sum)}# Create an empty list to store tables for each markermarker_table <- list()# Iterate over each marker and count positive occurrences for each inferred cell typefor (marker in markers) {  marker_table[[marker]] <- count_positives(celltypes, marker)}# Print the tablesfor (marker in markers) {  cat("Table for marker:", marker, "\n")  marker_table[[marker]]$InferredCellType = marker_table[[marker]]$Group.1   marker_table[[marker]]$Group.1 = NULL  print(marker_table[[marker]])  cat("\n")}combined_df <- NULLfor (marker in markers) {  if (is.null(combined_df)) {    combined_df <- marker_table[[marker]]    #colnames(combined_df) <- marker    print("ISNULL")  } else {    combined_df <- merge(combined_df, marker_table[[marker]], by = "InferredCellType", all = TRUE)    colnames(combined_df)[which(colnames(combined_df) == "x")] <- marker  }}combined_df$actin = combined_df$x.xcombined_df$cd3 = combined_df$x.ycombined_df$x.x = NULLcombined_df$x.y = NULLcombined_df$total = celltype_countsView(combined_df)write.csv(combined_df, file = "celltypeCounts_NucleiSeg.csv", row.names = FALSE)